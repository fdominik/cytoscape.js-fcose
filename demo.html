<!DOCTYPE>

<html>

  <head>
    <title>cytoscape-fcose.js demo</title>

      <meta name="viewport" content="width=device-width, user-scalable=no, initial-scale=1, maximum-scale=1">

      <script src="https://unpkg.com/cytoscape@3.2.20/dist/cytoscape.min.js"></script>
      <script src="https://code.jquery.com/jquery-3.0.0.min.js" crossorigin="anonymous"></script>
      <script src="https://unpkg.com/numeric/numeric-1.2.6.js"></script> 
      <script src="cytoscape-graphml.js"></script>
      <script src="cytoscape-tsv.js"></script>
      <!-- for testing with local version of cytoscape.js -->
      <!--<script src="../cytoscape.js/build/cytoscape.js"></script>-->

      <script src="cytoscape-fcose.js"></script>

      <style>
        body {
          font-family: helvetica neue, helvetica, liberation sans, arial, sans-serif;
          font-size: 14px;
        }

        #cy {
          position: absolute;
          width: 100%;
          height: 90%;
          z-index: 999;
        }

        h1 {
          opacity: 0.5;
          font-size: 1em;
          font-weight: bold;
        }
      </style>

      <script>
        document.addEventListener('DOMContentLoaded', function(){

          var cy = window.cy = cytoscape({
            container: document.getElementById('cy'),
            
            // demo your layout
            layout: {
              name: 'fcose',
              CMDS:  true,
              sampling: false

              // some more options here...
            },

            style: [
              {
                selector: 'node',
                style: {
                  'content': 'data(id)',
                }
              },

              {
                selector: 'edge',
                style: {
                  //'width': 0.1
                }
              }
            ],

            elements: {
              nodes: [
                { data: { id: 'n0'} },
                { data: { id: 'n1'} },
                { data: { id: 'n2'} },
                { data: { id: 'n3'} },
                { data: { id: 'n4'} },
                { data: { id: 'n5'} },
                { data: { id: 'n6'} },
                { data: { id: 'n7'} },
                { data: { id: 'n8'} }                                                 
              ],
              edges: [
                { data: { source: 'n0', target: 'n1' } },
                { data: { source: 'n1', target: 'n2' } },
                { data: { source: 'n3', target: 'n4' } },
                { data: { source: 'n4', target: 'n5' } },
                { data: { source: 'n6', target: 'n7' } },
                { data: { source: 'n7', target: 'n8' } },
                { data: { source: 'n0', target: 'n3' } },
                { data: { source: 'n3', target: 'n6' } },
                { data: { source: 'n1', target: 'n4' } },
                { data: { source: 'n4', target: 'n7' } },
                { data: { source: 'n2', target: 'n5' } },
                { data: { source: 'n5', target: 'n8' } }
              ]
            }
          });

          document.getElementById("CMDSlayoutButton").addEventListener("click", function(){
            var runNumber = document.getElementById("number").value;
            var isWeighted = document.getElementById("weightsCheckbox").checked;
            var size = document.getElementById("nodesize").value;

            var layout = cy.layout({
              name: 'fcose',
              CMDS: true,
              sampling: false,
              totalRuns: runNumber,
              weightedEdges: isWeighted,
              maxNodeSize: size
            });

            layout.run();
          });
          
          document.getElementById("CMDSSamplinglayoutButton").addEventListener("click", function(){
            var runNumber = document.getElementById("number").value;
            var isWeighted = document.getElementById("weightsCheckbox").checked;
            var size = document.getElementById("nodesize").value;

            var layout = cy.layout({
              name: 'fcose',
              CMDS: true,
              sampling: true,
              totalRuns: runNumber,
              weightedEdges: isWeighted,
              maxNodeSize: size
            });

                      console.log(runNumber);
            layout.run();
          });          

          document.getElementById("HDElayoutButton").addEventListener("click", function(){
            var runNumber = document.getElementById("number").value;
            var isWeighted = document.getElementById("weightsCheckbox").checked;
            var size = document.getElementById("nodesize").value;

            var layout = cy.layout({
              name: 'fcose',
              CMDS: false,
              totalRuns: runNumber,
              weightedEdges: isWeighted,
              maxNodeSize: size
            });

            layout.run();
          });
          
          document.getElementById('input').addEventListener("change", function() {
            var inputFile = this.files[0];
            if (inputFile) {
              var fileExtension = inputFile.name.split('.').pop();
              var r = new FileReader();
              r.onload = function(e) {
                cy.remove(cy.elements());
                var content = e.target.result;

                if(fileExtension == "graphml" || fileExtension == "xml"){
                  cy.graphml(content);
                }
                else{  
                  var tsv = cy.tsv();
                  tsv.importTo(content);
                }
            }
              r.readAsText(inputFile);
            } else { 
              alert("Failed to load file");
            }
          }, true);

        });
      </script>
  </head>

  <body>
          <h1>cytoscape-fcose demo</h1>
          <p>Average of <input type="text" id="number" size="3" value="1"> runtimes: <span id="runtime"></span></p>
          <p>Edge weights: <input type="checkbox" id="weightsCheckbox" value="false">
              Large Node: <input type="text" id="nodesize" size="3" value="30"></p>
          <button id="CMDSlayoutButton" type="button">CMDS</button>
          <button id="CMDSSamplinglayoutButton" type="button">CMDS-sampling</button>
          <button id="HDElayoutButton" type="button">HDE</button>
          <input type="file" id="input">

          <div id="cy"></div>

  </body>

</html>
